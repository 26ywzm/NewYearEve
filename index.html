<!DOCTYPE html>
<html lang="zh-CN">

<head>
  <meta charset="UTF-8" />
  <title>è·¨å¹´ç‹‚æ¬¢å¤œ Â· æ¬¢è¿ä¸€èµ·è¿æ¥æ–°å¹´</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />

  <style>
    /* å…¨å±€æ ·å¼é‡ç½® */
    * {
      margin: 0;
      padding: 0;
      box-sizing: border-box;
    }

    body {
      font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
        "PingFang SC", "Microsoft YaHei", sans-serif;
      background: radial-gradient(circle at top, #2b0b0b 0%, #060310 50%, #02010a 100%);
      color: #fff;
      min-height: 100vh;
      overflow-x: hidden;
    }

    a {
      text-decoration: none;
      color: inherit;
    }

    /* é¡¶éƒ¨å¯¼èˆª */
    /* é¡¶éƒ¨å¯¼èˆªï¼ˆèƒ¶å›Šæ‚¬æµ®æ•ˆæœï¼‰ */
    header {
      position: fixed;
      top: 0;
      left: 0;
      right: 0;
      z-index: 100;
      pointer-events: none;
      /* åªè®©é‡Œé¢çš„å¯¼èˆªå¯ç‚¹ */
    }

    .nav {
      max-width: 1100px;
      margin: 10px auto 0;
      padding: 6px 16px;
      display: flex;
      align-items: center;
      justify-content: space-between;
      pointer-events: auto;
      background: radial-gradient(circle at top, rgba(255, 255, 255, 0.28), rgba(255, 255, 255, 0.04));
      background-color: rgba(5, 5, 20, 0.8);
      border-radius: 999px;
      border: 1px solid rgba(255, 255, 255, 0.12);
      box-shadow: 0 18px 40px rgba(0, 0, 0, 0.65);
      backdrop-filter: blur(14px);
      gap: 18px;
    }

    .nav-logo {
      display: flex;
      align-items: center;
      gap: 8px;
      font-weight: 700;
      letter-spacing: 1px;
      font-size: 15px;
      color: #ffe9a6;
      white-space: nowrap;
    }

    .nav-logo-icon {
      width: 26px;
      height: 26px;
      border-radius: 999px;
      border: 1px solid rgba(255, 217, 102, 0.7);
      display: flex;
      align-items: center;
      justify-content: center;
      font-size: 14px;
      background: radial-gradient(circle at 30% 30%, #ffd966, #ff7b39);
      box-shadow:
        0 0 10px rgba(255, 217, 102, 0.9),
        0 0 24px rgba(255, 120, 60, 0.7);
    }

    .nav-links {
      display: inline-flex;
      align-items: center;
      gap: 6px;
      font-size: 13px;
      padding: 2px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.25);
    }

    .nav-links a {
      position: relative;
      padding: 5px 14px;
      border-radius: 999px;
      cursor: pointer;
      border: 1px solid transparent;
      color: rgba(255, 255, 255, 0.8);
      display: inline-flex;
      align-items: center;
      gap: 4px;
      transition:
        background 0.2s ease,
        border-color 0.2s ease,
        color 0.2s ease,
        transform 0.15s ease,
        box-shadow 0.15s ease;
      text-decoration: none;
      white-space: nowrap;
    }

    .nav-links a::before {
      content: "â€¢";
      font-size: 10px;
      opacity: 0.6;
    }

    .nav-links a:hover {
      background: radial-gradient(circle at top, rgba(255, 217, 102, 0.25), rgba(255, 255, 255, 0.04));
      border-color: rgba(255, 217, 102, 0.6);
      color: #fff;
      transform: translateY(-1px);
      box-shadow: 0 6px 14px rgba(0, 0, 0, 0.55);
    }

    /* é«˜äº®â€œå€’è®¡æ—¶â€æŒ‰é’® */
    #navCountdown {
      background: radial-gradient(circle at top, rgba(255, 217, 102, 0.4), rgba(255, 153, 51, 0.5));
      border-color: rgba(255, 217, 102, 0.9);
      color: #301400;
      font-weight: 600;
      box-shadow: 0 6px 16px rgba(0, 0, 0, 0.6);
    }

    #navCountdown::before {
      content: "â±";
      opacity: 0.9;
      font-size: 13px;
    }

    /* â€œæ–°å¹´ç¥ç¦â€â€œæ„¿æœ›æ¸…å•â€å‰åŠ å°å›¾æ ‡ */
    #navBlessings::before {
      content: "ğŸŠ";
      font-size: 13px;
      opacity: 0.9;
    }

    .nav-links a[href="#wishes"]::before {
      content: "ğŸ“";
      font-size: 13px;
      opacity: 0.9;
    }

    @media (max-width: 640px) {
      .nav {
        padding-inline: 10px;
        gap: 10px;
      }

      .nav-logo span {
        display: none;
        /* å°å±åªæ˜¾ç¤ºåœ†å½¢å›¾æ ‡ */
      }

      .nav-links {
        font-size: 12px;
      }

      .nav-links a {
        padding-inline: 10px;
      }
    }


    /* ä¸»ä½“å®¹å™¨ */
    main {
      max-width: 1100px;
      margin: 0 auto;
      padding: 100px 16px 40px;
      /* ç•™å‡ºé¡¶éƒ¨å¯¼èˆªé«˜åº¦ */
    }

    /* è‹±é›„åŒºåŸŸï¼šå€’è®¡æ—¶ */
    .hero {
      position: relative;
      border-radius: 24px;
      padding: 32px 22px 26px;
      overflow: hidden;
      background: linear-gradient(135deg, rgba(128, 0, 0, 0.9), rgba(193, 52, 18, 0.95));
      box-shadow: 0 28px 50px rgba(0, 0, 0, 0.6);
      display: grid;
      grid-template-columns: minmax(0, 3fr) minmax(0, 2.2fr);
      gap: 18px;
      align-items: center;
    }

    @media (max-width: 768px) {
      .hero {
        grid-template-columns: 1fr;
      }
    }

    .hero::before {
      content: "";
      position: absolute;
      inset: 0;
      background-image:
        radial-gradient(circle at 10% 20%, rgba(255, 215, 0, 0.3) 0, transparent 50%),
        radial-gradient(circle at 80% 0%, rgba(255, 99, 71, 0.25) 0, transparent 55%);
      pointer-events: none;
      /* ä¸æŒ¡ä½ä¸‹é¢çš„ç‚¹å‡» */
    }

    .hero-left,
    .hero-right {
      position: relative;
      z-index: 1;
    }

    .hero-pill {
      display: inline-flex;
      align-items: center;
      gap: 8px;
      padding: 4px 12px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.25);
      border: 1px solid rgba(255, 217, 102, 0.7);
      font-size: 12px;
      margin-bottom: 12px;
    }

    .hero-pill-dot {
      width: 8px;
      height: 8px;
      border-radius: 50%;
      background: #ffd966;
      box-shadow: 0 0 8px rgba(255, 217, 102, 0.9);
    }

    .hero-title {
      font-size: clamp(26px, 4vw, 36px);
      font-weight: 800;
      line-height: 1.2;
      margin-bottom: 10px;
    }

    .hero-title span {
      color: #ffd966;
      text-shadow: 0 0 18px rgba(255, 217, 102, 0.8);
    }

    .hero-subtitle {
      font-size: 14px;
      opacity: 0.92;
      margin-bottom: 18px;
    }

    .hero-actions {
      display: flex;
      flex-wrap: wrap;
      gap: 10px;
      margin-top: 6px;
    }

    .btn-primary,
    .btn-ghost {
      border-radius: 999px;
      padding: 9px 18px;
      font-size: 14px;
      border: none;
      cursor: pointer;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      transition: transform 0.15s ease, box-shadow 0.15s ease, background 0.15s ease, opacity 0.15s ease;
      white-space: nowrap;
    }

    .btn-primary {
      background: linear-gradient(135deg, #ffd966, #ffb347);
      color: #3a1300;
      box-shadow: 0 12px 20px rgba(0, 0, 0, 0.5);
      font-weight: 600;
    }

    .btn-primary:hover {
      transform: translateY(-1px);
      box-shadow: 0 16px 25px rgba(0, 0, 0, 0.7);
    }

    .btn-ghost {
      background: rgba(0, 0, 0, 0.15);
      border: 1px solid rgba(255, 217, 102, 0.7);
      color: #ffd966;
    }

    .btn-ghost:hover {
      background: rgba(0, 0, 0, 0.3);
      transform: translateY(-1px);
    }

    .btn-icon {
      font-size: 16px;
    }

    /* å€’è®¡æ—¶åŒºå— */
    .countdown-card {
      background: rgba(0, 0, 0, 0.28);
      border-radius: 18px;
      padding: 16px 14px;
      border: 1px solid rgba(255, 217, 102, 0.5);
      box-shadow: 0 12px 25px rgba(0, 0, 0, 0.6);
    }

    .countdown-card-title {
      font-size: 14px;
      margin-bottom: 10px;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 10px;
    }

    .countdown-target {
      font-size: 12px;
      opacity: 0.8;
    }

    .countdown-grid {
      display: grid;
      grid-template-columns: repeat(4, minmax(0, 1fr));
      gap: 8px;
    }

    .countdown-item {
      text-align: center;
      background: rgba(0, 0, 0, 0.55);
      border-radius: 14px;
      padding: 8px 6px;
      border: 1px solid rgba(255, 255, 255, 0.04);
      position: relative;
      overflow: hidden;
    }

    .countdown-item::before {
      content: "";
      position: absolute;
      inset: 0;
      background: radial-gradient(circle at top, rgba(255, 217, 102, 0.19), transparent 60%);
      opacity: 0;
      transition: opacity 0.35s ease;
      pointer-events: none;
    }

    .countdown-item.active::before {
      opacity: 1;
    }

    .countdown-value {
      font-size: 20px;
      font-weight: 700;
      letter-spacing: 1px;
    }

    .countdown-label {
      font-size: 11px;
      opacity: 0.85;
    }

    .countdown-footer {
      margin-top: 10px;
      font-size: 12px;
      opacity: 0.9;
      display: flex;
      justify-content: space-between;
      align-items: center;
      gap: 8px;
    }

    .countdown-status {
      font-weight: 600;
      color: #ffd966;
    }

    .countdown-tag {
      padding: 3px 8px;
      border-radius: 999px;
      background: rgba(255, 255, 255, 0.05);
      font-size: 11px;
    }

    /* æ–°ï¼šçˆ†ç‚¸çƒŸèŠ±èƒŒæ™¯ */
    #fireworksCanvas {
      position: fixed;
      inset: 0;
      z-index: 0;
      pointer-events: none;
    }


    /* ç¥ç¦åŒºå— */
    section {
      margin-top: 28px;
    }

    .section-title {
      font-size: 18px;
      font-weight: 700;
      display: inline-flex;
      align-items: center;
      gap: 8px;
      margin-bottom: 14px;
    }

    .section-title-icon {
      font-size: 18px;
    }

    .blessing-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 14px;
    }

    .card {
      background: rgba(0, 0, 0, 0.35);
      border-radius: 18px;
      padding: 14px 14px 12px;
      border: 1px solid rgba(255, 255, 255, 0.04);
      box-shadow: 0 12px 20px rgba(0, 0, 0, 0.55);
      position: relative;
      overflow: hidden;
    }

    .card::before {
      content: "";
      position: absolute;
      inset: 0;
      background: linear-gradient(135deg, rgba(255, 215, 102, 0.08), transparent 60%);
      opacity: 0;
      transition: opacity 0.3s ease;
      pointer-events: none;
      /* é˜²æ­¢æŒ¡ä½ textarea å’ŒæŒ‰é’®ç‚¹å‡» */
    }

    .card:hover::before {
      opacity: 1;
    }

    .card-title {
      font-size: 15px;
      font-weight: 600;
      margin-bottom: 6px;
      display: inline-flex;
      align-items: center;
      gap: 6px;
    }

    .card-tag {
      font-size: 11px;
      padding: 3px 7px;
      border-radius: 999px;
      background: rgba(255, 217, 102, 0.15);
      border: 1px solid rgba(255, 217, 102, 0.4);
      color: #ffd966;
    }

    .card-body {
      font-size: 13px;
      line-height: 1.5;
      opacity: 0.9;
    }

    /* æ„¿æœ›æ¸…å• */
    .wish-list {
      list-style: none;
      font-size: 13px;
      display: grid;
      gap: 6px;
      margin-top: 4px;
    }

    .wish-item::before {
      content: "â­";
      margin-right: 4px;
      font-size: 11px;
    }

    /* é¡µè„š */
    footer {
      margin-top: 28px;
      padding: 18px 16px 24px;
      font-size: 12px;
      color: rgba(255, 255, 255, 0.7);
      border-top: 1px solid rgba(255, 255, 255, 0.05);
      text-align: center;
    }

    .footer-highlight {
      color: #ffd966;
    }

    /* ========= å…¨å±å¤§å€’è®¡æ—¶ ========= */
    .fullscreen-countdown {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, #2b0b0b 0%, #060310 50%, #02010a 100%);
      z-index: 200;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
    }

    .fullscreen-countdown.active {
      opacity: 1;
      pointer-events: auto;
    }

    .fullscreen-label {
      font-size: 18px;
      letter-spacing: 4px;
      margin-bottom: 16px;
      opacity: 0.9;
    }

    .fullscreen-time {
      display: flex;
      align-items: baseline;
      flex-wrap: wrap;
      justify-content: center;
      gap: 10px;
      margin-bottom: 10px;
    }

    .fullscreen-time span {
      font-size: clamp(36px, 9vw, 80px);
      font-weight: 800;
      text-shadow: 0 0 20px rgba(255, 217, 102, 0.9);
    }

    .fullscreen-time small {
      font-size: clamp(16px, 3vw, 28px);
      margin: 0 4px;
      opacity: 0.9;
    }

    .fullscreen-status {
      font-size: 14px;
      margin-top: 6px;
      opacity: 0.9;
    }

    .fullscreen-close {
      position: absolute;
      top: 16px;
      right: 16px;
      border-radius: 999px;
      padding: 6px 12px;
      border: 1px solid rgba(255, 255, 255, 0.25);
      background: rgba(0, 0, 0, 0.35);
      color: #fff;
      cursor: pointer;
      font-size: 13px;
    }

    .fullscreen-close:hover {
      background: rgba(0, 0, 0, 0.6);
    }

    /* ========= æ–°å¹´ç¥ç¦è¦†ç›–å±‚ + å°çª— ========= */
    .blessing-overlay {
      position: fixed;
      inset: 0;
      background: radial-gradient(circle at top, #2b0b0b 0%, #060310 50%, #02010a 100%);
      z-index: 195;
      opacity: 0;
      pointer-events: none;
      transition: opacity 0.3s ease;
      overflow: hidden;
    }

    .blessing-overlay.active {
      opacity: 1;
      pointer-events: auto;
    }

    .blessing-window {
      position: absolute;
      width: 260px;
      border-radius: 14px;
      background: #fdfdfd;
      color: #333;
      box-shadow: 0 12px 28px rgba(0, 0, 0, 0.6);
      overflow: hidden;
      font-size: 13px;
      border: 1px solid rgba(0, 0, 0, 0.08);
      opacity: 0;
      /* åˆå§‹ä¸å¯è§ */
      transform: translateY(8px) scale(0.92);
    }

    /* å°çª—å‡ºç°åæ·»åŠ  .show ç±»ï¼Œæ‰§è¡Œå¼¹å‡º + è½»å¾®æµ®åŠ¨åŠ¨ç”» */
    .blessing-window.show {
      opacity: 1;
      animation: blessing-in 0.35s ease-out,
        blessing-float 6s ease-in-out infinite;
    }


    .blessing-window-header {
      height: 30px;
      background: #f5f5f5;
      display: flex;
      align-items: center;
      padding: 0 10px;
      font-size: 12px;
      color: #444;
      justify-content: space-between;
    }

    .blessing-window-header-title {
      display: flex;
      align-items: center;
      gap: 6px;
    }

    .blessing-window-header-dot {
      width: 10px;
      height: 10px;
      border-radius: 50%;
      background: #4c8bf5;
    }

    .blessing-window-body {
      padding: 14px 16px;
      background: var(--window-bg, #fff7d6);
      line-height: 1.6;
      font-size: 14px;
      word-break: break-all;
    }

    @keyframes blessing-in {
      from {
        opacity: 0;
        transform: translateY(14px) scale(0.9);
      }

      to {
        opacity: 1;
        transform: translateY(0) scale(1);
      }
    }

    @keyframes blessing-float {
      0% {
        transform: translateY(0) scale(1);
      }

      50% {
        transform: translateY(-6px) scale(1);
      }

      100% {
        transform: translateY(0) scale(1);
      }
    }


    /* ========= éŸ³ä¹æ§åˆ¶æŒ‰é’® ========= */
    .music-control {
      position: fixed;
      right: 16px;
      bottom: 16px;
      z-index: 150;
      display: inline-flex;
      align-items: center;
      gap: 6px;
      padding: 6px 10px;
      border-radius: 999px;
      background: rgba(0, 0, 0, 0.45);
      border: 1px solid rgba(255, 217, 102, 0.7);
      font-size: 12px;
      cursor: pointer;
      backdrop-filter: blur(8px);
    }

    .music-control-icon {
      font-size: 16px;
    }

    .music-control:hover {
      background: rgba(0, 0, 0, 0.7);
    }
  </style>
</head>

<body>
  <!-- çƒŸèŠ±èƒŒæ™¯ -->
  <canvas id="fireworksCanvas"></canvas>

  <!-- èƒŒæ™¯éŸ³ä¹ï¼ˆè¯·æŠŠ music.mp3 æ”¾åœ¨åŒç›®å½•ä¸‹ï¼Œæˆ–è€…æ”¹æˆè‡ªå·±çš„éŸ³ä¹åœ°å€ï¼‰ -->
  <audio id="bgm" loop>
    <!-- ä¾‹å¦‚ï¼š<source src="music.mp3" type="audio/mpeg" /> -->
  </audio>

  <!-- éŸ³ä¹æ§åˆ¶æŒ‰é’® -->
  <button class="music-control" id="musicToggle">
    <span class="music-control-icon" id="musicIcon">ğŸ”‡</span>
    <span id="musicText">ç‚¹å‡»æ’­æ”¾éŸ³ä¹</span>
  </button>

  <!-- é¡¶éƒ¨å¯¼èˆª -->
  <header>
    <div class="nav">
      <div class="nav-logo">
        <div class="nav-logo-icon">æ–°</div>
        <span>è·¨å¹´ä¹‹å¤œ</span>
      </div>
      <nav class="nav-links">
        <a id="navCountdown">å€’è®¡æ—¶</a>
        <a id="navBlessings">æ–°å¹´ç¥ç¦</a>
        <a href="#wishes">æ„¿æœ›æ¸…å•</a>
      </nav>
    </div>
  </header>

  <!-- å…¨å±å¤§å€’è®¡æ—¶ -->
  <div class="fullscreen-countdown" id="fullscreenCountdown">
    <button class="fullscreen-close" id="closeFullscreen">å…³é—­ âœ•</button>
    <div class="fullscreen-label">è·¨å¹´å€’è®¡æ—¶</div>
    <div class="fullscreen-time">
      <span id="bigDays">00</span><small>å¤©</small>
      <span id="bigHours">00</span><small>æ—¶</small>
      <span id="bigMinutes">00</span><small>åˆ†</small>
      <span id="bigSeconds">00</span><small>ç§’</small>
    </div>
    <div class="fullscreen-status" id="bigStatus">è·¨å¹´å³å°†åˆ°æ¥â€¦</div>
  </div>

  <!-- æ–°å¹´ç¥ç¦è¦†ç›–å±‚ï¼šå°çª—åœ¨ JS é‡ŒåŠ¨æ€ç”Ÿæˆ -->
  <div class="blessing-overlay" id="blessingOverlay">
    <button class="fullscreen-close" id="closeBlessing">å…³é—­ âœ•</button>
  </div>

  <!-- ä¸»å†…å®¹ -->
  <main>
    <!-- è‹±é›„åŒºï¼šå€’è®¡æ—¶ -->
    <section class="hero" id="countdown">
      <div class="hero-left">
        <div class="hero-pill">
          <span class="hero-pill-dot"></span>
          <span>è·¨å¹´ç‹‚æ¬¢å¤œ Â· HAPPY NEW YEAR</span>
        </div>
        <h1 class="hero-title">
          ä¸€èµ·è¿æ¥ <span>æ–°çš„ä¸€å¹´</span> âœ¨
        </h1>
        <p class="hero-subtitle">
          è¿™ä¸€å¹´æˆ‘ä»¬æœ‰æ”¶è·ä¹Ÿæœ‰é—æ†¾ï¼Œä½†è·¨è¿‡é›¶ç‚¹ï¼Œå°±æ˜¯å…¨æ–°çš„å¼€å§‹ã€‚<br />
          å†™ä¸‹ä½ çš„æ„¿æœ›ï¼Œè®°å½•è¿™ä¸€åˆ»çš„å¿ƒæƒ…ï¼ŒæŠŠæœ€ç¿çƒ‚çš„ç¥ç¦ç•™åœ¨è¿™é¡µé‡Œã€‚
        </p>
        <div class="hero-actions">
          <button class="btn-primary" id="scrollToBlessings">
            <span class="btn-icon">ğŸ‰</span> æŸ¥çœ‹æ–°å¹´ç¥ç¦
          </button>
          <button class="btn-ghost" id="scrollToWishes">
            <span class="btn-icon">ğŸ“</span> å†™ä¸‹æˆ‘çš„æ„¿æœ›
          </button>
        </div>
      </div>

      <div class="hero-right">
        <div class="countdown-card">
          <div class="countdown-card-title">
            <span>è·¨å¹´å€’è®¡æ—¶</span>
            <span class="countdown-target" id="countdownTargetText"></span>
          </div>
          <div class="countdown-grid">
            <div class="countdown-item" id="cd-days">
              <div class="countdown-value" id="days">00</div>
              <div class="countdown-label">å¤©</div>
            </div>
            <div class="countdown-item" id="cd-hours">
              <div class="countdown-value" id="hours">00</div>
              <div class="countdown-label">æ—¶</div>
            </div>
            <div class="countdown-item" id="cd-minutes">
              <div class="countdown-value" id="minutes">00</div>
              <div class="countdown-label">åˆ†</div>
            </div>
            <div class="countdown-item" id="cd-seconds">
              <div class="countdown-value" id="seconds">00</div>
              <div class="countdown-label">ç§’</div>
            </div>
          </div>
          <div class="countdown-footer">
            <span class="countdown-status" id="countdownStatus">è·¨å¹´å³å°†åˆ°æ¥â€¦</span>
            <span class="countdown-tag">å‡†å¤‡å¥½è¿æ¥æ–°å¹´äº†å—ï¼Ÿ</span>
          </div>
        </div>
      </div>
    </section>

    <!-- æ–°å¹´ç¥ç¦ -->
    <section id="blessings">
      <h2 class="section-title">
        <span class="section-title-icon">ğŸŠ</span>
        <span>æ–°å¹´ç¥ç¦ Â· å¥½è¿è¿è¿</span>
      </h2>
      <div class="blessing-grid">
        <article class="card">
          <h3 class="card-title">
            ğŸ ç»™è‡ªå·±çš„ç¥ç¦
            <span class="card-tag">åŠªåŠ› + å¥½è¿</span>
          </h3>
          <p class="card-body">
            æ„¿æ–°çš„ä¸€å¹´ï¼Œä¿æŒçƒ­çˆ±ï¼Œä¿æŒè‡ªå¾‹ï¼Œä¿æŒå‘å‰èµ°çš„å‹‡æ°”ã€‚<br />
            ä¸ç”¨ä¸€ä¸‹å­åšåˆ°æœ€å¥½ï¼Œä½†æ¯ä¸€å¤©éƒ½æ¯”æ˜¨å¤©æ›´æ¥è¿‘ç›®æ ‡ä¸€ç‚¹ç‚¹ã€‚
          </p>
        </article>

        <article class="card">
          <h3 class="card-title">
            ğŸ‘¨â€ğŸ‘©â€ğŸ‘§â€ğŸ‘¦ ç»™å®¶äººçš„ç¥ç¦
            <span class="card-tag">å¹³å®‰å¥åº·</span>
          </h3>
          <p class="card-body">
            æ„¿å®¶äººå¹³å®‰å–œä¹ï¼Œç¬‘å®¹å¸¸åœ¨ï¼›ä¸‰é¤å››å­£ï¼Œæœ‰äººç­‰ä½ å›å®¶ã€‚<br />
            æ–°çš„ä¸€å¹´ï¼Œå¤šå›å‡ æ¬¡å®¶ï¼Œå¤šè¯´å‡ å¥â€œè¾›è‹¦äº†â€ã€‚
          </p>
        </article>

        <article class="card">
          <h3 class="card-title">
            ğŸ¤ ç»™æœ‹å‹çš„ç¥ç¦
            <span class="card-tag">ä¸€è·¯ç›¸ä¼´</span>
          </h3>
          <p class="card-body">
            æ„¿æˆ‘ä»¬éƒ½ä¸è¢«ç”Ÿæ´»æ‰“è´¥ï¼Œå¶å°”æƒ…ç»ªå´©æºƒï¼Œä¹Ÿæœ‰äººèƒ½å¬ä½ è®²å®Œã€‚<br />
            æ–°ä¸€å¹´ä¸€èµ·åƒå¥½åƒçš„ã€çœ‹å¥½çœ‹çš„é£æ™¯ã€åšæœ‰è¶£çš„äº‹ã€‚
          </p>
        </article>

        <article class="card">
          <h3 class="card-title">
            ğŸ’¼ ç»™æœªæ¥çš„è‡ªå·±
            <span class="card-tag">ä¸æ–­æˆé•¿</span>
          </h3>
          <p class="card-body">
            ä¹Ÿè®¸ç°åœ¨è¿˜æœ‰ç‚¹è¿·èŒ«ï¼Œä½†æ²¡å…³ç³»ï¼Œåªè¦ä¸åœæ­¢å­¦ä¹ å’Œå°è¯•ï¼Œ<br />
            è‹¥å¹²å¹´åå†å›å¤´çœ‹è¿™ä¸€å¹´ï¼Œéƒ½ä¼šå˜æˆå¾ˆé…·çš„ä¼ç¬”ã€‚
          </p>
        </article>
      </div>
    </section>

    <!-- æ„¿æœ›æ¸…å• -->
    <section id="wishes">
      <h2 class="section-title">
        <span class="section-title-icon">ğŸ“</span>
        <span>æˆ‘çš„æ–°å¹´æ„¿æœ›æ¸…å•</span>
      </h2>

      <div class="blessing-grid">
        <article class="card">
          <h3 class="card-title">
            âœ… ä»Šå¹´çš„å°ç›®æ ‡
            <span class="card-tag">å¯å®ç°çš„è®¡åˆ’</span>
          </h3>
          <ul class="wish-list" id="wishListDefault">
            <li class="wish-item">åšæŒä¸€ä»¶è‡ªå·±çš„çˆ±å¥½ï¼Œä¸è½»æ˜“æ”¾å¼ƒ</li>
            <li class="wish-item">ä¿æŒè§„å¾‹ä½œæ¯ï¼Œå°‘ç†¬å¤œï¼Œå¤šè¿åŠ¨</li>
            <li class="wish-item">æå‡ä¸“ä¸šæŠ€èƒ½æˆ–å­¦ä¹ ä¸€é¡¹æ–°æŠ€èƒ½</li>
            <li class="wish-item">å¯¹èº«è¾¹çš„äººå¤šä¸€ç‚¹è€å¿ƒä¸æ¸©æŸ”</li>
          </ul>
        </article>

        <article class="card">
          <h3 class="card-title">
            âœï¸ å†™ä¸‹æˆ‘çš„æ„¿æœ›
            <span class="card-tag">æœ¬åœ°ä¿å­˜</span>
          </h3>
          <p class="card-body" style="margin-bottom:6px;">
            åœ¨ä¸‹é¢è¾“å…¥ä½ çš„æ–°å¹´æ„¿æœ›ï¼Œç‚¹å‡»â€œä¿å­˜æ„¿æœ›â€ï¼Œå®ƒä¼šä¿å­˜åœ¨å½“å‰è®¾å¤‡çš„æµè§ˆå™¨ä¸­ï¼Œ
            ä¸‹æ¬¡æ‰“å¼€è¿™ä¸ªé¡µé¢æ—¶ä¾ç„¶å¯ä»¥çœ‹åˆ°ï¼ˆä¸ä¼šä¸Šä¼ åˆ°æœåŠ¡å™¨ï¼‰ã€‚
          </p>
          <textarea id="wishInput" rows="4" placeholder="ä¾‹å¦‚ï¼šå¸Œæœ›é¡ºåˆ©é€šè¿‡è€ƒè¯• / æ‰¾åˆ°ç†æƒ³å·¥ä½œ / å»ä¸€æ¬¡æƒ³å»å¾ˆä¹…çš„åŸå¸‚..."
            style="width: 100%; resize: vertical; border-radius: 12px; border: 1px solid rgba(255,255,255,0.15); padding: 8px 10px; background: rgba(0,0,0,0.35); color: #fff; font-size: 13px; outline: none;"></textarea>
          <div style="display:flex; justify-content:flex-end; gap:8px; margin-top:8px; flex-wrap:wrap;">
            <button class="btn-ghost" id="clearWish">
              æ¸…ç©º
            </button>
            <button class="btn-primary" id="saveWish">
              ä¿å­˜æ„¿æœ›
            </button>
          </div>
          <p id="wishSavedHint" style="font-size:11px; opacity:0.8; margin-top:6px;"></p>
        </article>
      </div>
    </section>
  </main>

  <!-- é¡µè„š -->
  <footer>
    <div>
      æ„¿æ–°çš„ä¸€å¹´ï¼Œ<span class="footer-highlight">æ‰€æœ‰çš„åšæŒéƒ½æœ‰å›å“ï¼Œæ‰€æœ‰çš„åŠªåŠ›éƒ½æœ‰ç­”æ¡ˆ</span>ã€‚
    </div>
    <div style="margin-top:4px;">Cross-Year Â· Happy New Year Â· æ–°å¹´å¿«ä¹</div>
  </footer>

  <script>
    // ================== è·¨å¹´æ—¶é—´è®¾ç½® ==================
    const targetDate = new Date("2025-12-31T23:59:59"); // æœ¬åœ°æ—¶é—´

    const targetTextEl = document.getElementById("countdownTargetText");
    if (targetTextEl) {
      const y = targetDate.getFullYear();
      const m = String(targetDate.getMonth() + 1).padStart(2, "0");
      const d = String(targetDate.getDate()).padStart(2, "0");
      const hh = String(targetDate.getHours()).padStart(2, "0");
      const mm = String(targetDate.getMinutes()).padStart(2, "0");
      targetTextEl.textContent = `${y}å¹´${m}æœˆ${d}æ—¥ ${hh}:${mm}`;
    }

    // ================== å€’è®¡æ—¶é€»è¾‘ï¼ˆå°å¡ç‰‡ + å¤§å…¨å± å…±ç”¨ï¼‰ ==================
    const daysEl = document.getElementById("days");
    const hoursEl = document.getElementById("hours");
    const minutesEl = document.getElementById("minutes");
    const secondsEl = document.getElementById("seconds");
    const statusEl = document.getElementById("countdownStatus");

    const cdDays = document.getElementById("cd-days");
    const cdHours = document.getElementById("cd-hours");
    const cdMinutes = document.getElementById("cd-minutes");
    const cdSeconds = document.getElementById("cd-seconds");

    const bigDaysEl = document.getElementById("bigDays");
    const bigHoursEl = document.getElementById("bigHours");
    const bigMinutesEl = document.getElementById("bigMinutes");
    const bigSecondsEl = document.getElementById("bigSeconds");
    const bigStatusEl = document.getElementById("bigStatus");

    function updateCountdown() {
      const now = new Date();
      const diff = targetDate - now;

      if (diff <= 0) {
        const msg = "ğŸ‰ æ–°å¹´å¿«ä¹ï¼æ„¿ä½ è¿™ä¸€å¹´å¿ƒæƒ³äº‹æˆï¼";
        ["00", "00", "00", "00"].forEach((v, i) => {
          [daysEl, hoursEl, minutesEl, secondsEl][i].textContent = v;
          [bigDaysEl, bigHoursEl, bigMinutesEl, bigSecondsEl][i].textContent = v;
        });
        statusEl.textContent = msg;
        bigStatusEl.textContent = msg;

        cdDays.classList.remove("active");
        cdHours.classList.remove("active");
        cdMinutes.classList.remove("active");
        cdSeconds.classList.add("active");
        return;
      }

      const totalSeconds = Math.floor(diff / 1000);
      const days = Math.floor(totalSeconds / (3600 * 24));
      const hours = Math.floor((totalSeconds % (3600 * 24)) / 3600);
      const minutes = Math.floor((totalSeconds % 3600) / 60);
      const seconds = totalSeconds % 60;

      const dStr = String(days).padStart(2, "0");
      const hStr = String(hours).padStart(2, "0");
      const mStr = String(minutes).padStart(2, "0");
      const sStr = String(seconds).padStart(2, "0");

      daysEl.textContent = dStr;
      hoursEl.textContent = hStr;
      minutesEl.textContent = mStr;
      secondsEl.textContent = sStr;

      bigDaysEl.textContent = dStr;
      bigHoursEl.textContent = hStr;
      bigMinutesEl.textContent = mStr;
      bigSecondsEl.textContent = sStr;

      cdDays.classList.remove("active");
      cdHours.classList.remove("active");
      cdMinutes.classList.remove("active");
      cdSeconds.classList.remove("active");

      if (days > 0) {
        cdDays.classList.add("active");
      } else if (hours > 0) {
        cdHours.classList.add("active");
      } else if (minutes > 0) {
        cdMinutes.classList.add("active");
      } else {
        cdSeconds.classList.add("active");
      }

      if (days === 0 && hours < 6) {
        const text = "â° è·¨å¹´è¿›å…¥å€’è®¡æ—¶ï¼Œè®°å¾—å’Œé‡è¦çš„äººä¸€èµ·è¿æ¥å“¦ï½";
        statusEl.textContent = text;
        bigStatusEl.textContent = text;
      } else {
        const text = "è·¨å¹´å³å°†åˆ°æ¥â€¦";
        statusEl.textContent = text;
        bigStatusEl.textContent = text;
      }
    }

    updateCountdown();
    setInterval(updateCountdown, 1000);

    // ================== æ»šåŠ¨æŒ‰é’® ==================
    document.getElementById("scrollToBlessings")?.addEventListener("click", () => {
      document.getElementById("blessings")?.scrollIntoView({ behavior: "smooth" });
    });

    document.getElementById("scrollToWishes")?.addEventListener("click", () => {
      document.getElementById("wishes")?.scrollIntoView({ behavior: "smooth" });
    });

    // ================== å¯¼èˆªæ ï¼šå…¨å±å¤§å€’è®¡æ—¶ ==================
    const navCountdownLink = document.getElementById("navCountdown");
    const fullscreenCountdown = document.getElementById("fullscreenCountdown");
    const closeFullscreenBtn = document.getElementById("closeFullscreen");

    navCountdownLink?.addEventListener("click", (e) => {
      e.preventDefault();
      fullscreenCountdown.classList.add("active");
    });

    closeFullscreenBtn?.addEventListener("click", () => {
      fullscreenCountdown.classList.remove("active");
    });

    fullscreenCountdown?.addEventListener("click", (e) => {
      if (e.target === fullscreenCountdown) {
        fullscreenCountdown.classList.remove("active");
      }
    });

    // ================== å¯¼èˆªæ ï¼šæ–°å¹´ç¥ç¦å°çª—é“ºæ»¡æ•ˆæœ ==================
    const navBlessingsLink = document.getElementById("navBlessings");
    const blessingOverlay = document.getElementById("blessingOverlay");
    const blessingCloseBtn = document.getElementById("closeBlessing");

    const blessingsArr = [
      "æ„¿æ–°çš„ä¸€å¹´ï¼Œæ‰€æœ‰çš„åŠªåŠ›éƒ½æœ‰å›å“ï¼Œæ‰€æœ‰çš„ä»˜å‡ºéƒ½æœ‰æ”¶è·ã€‚",
      "æ„¿ä½ çœ¼é‡Œæœ‰å…‰ï¼Œå¿ƒä¸­æœ‰æ¢¦ï¼Œè„šä¸‹æœ‰è·¯ï¼Œèº«è¾¹æœ‰äººåŒè¡Œã€‚",
      "æ„¿å®¶äººå¹³å®‰å¥åº·ï¼Œä¸‰é¤å››å­£éƒ½å……æ»¡çƒŸç«ä¸æ¬¢ç¬‘ã€‚",
      "æ„¿ä½ åœ¨ä½è°·ä¸å¤±å‹‡æ°”ï¼Œåœ¨é¡ºé£æ—¶ä¸å¤±æœ¬å¿ƒã€‚",
      "æ„¿æ‰€æœ‰çš„é—æ†¾ï¼Œéƒ½æ˜¯æ¥å¹´æƒŠå–œçš„é“ºå«ã€‚",
      "æ„¿ä½ è¢«ä¸–ç•Œæ¸©æŸ”ä»¥å¾…ï¼Œä¹Ÿå­¦ä¼šæ¸©æŸ”åœ°æ‹¥æŠ±è‡ªå·±ã€‚",
      "æ„¿ä½ èµ°è¿‡çš„æ¯ä¸€æ®µè·¯ï¼Œéƒ½ç•™ä¸‹åšå®šè€Œè‡ªä¿¡çš„è„šå°ã€‚",
      "æ„¿ä½ å¸¸æ€€æœŸå¾…ï¼Œä¹Ÿä¸æƒ§æ”¹å˜ï¼Œæœªæ¥ä¸€å®šä¼šè¶Šæ¥è¶Šå¥½ã€‚",
      "æ„¿ä½ ä¿æŒçƒ­çˆ±ï¼Œä¸ç”Ÿæ´»æ¡æ‰‹è¨€å’Œã€‚",
      "æ„¿ä½ åœ¨æ–°çš„ä¸€å¹´é‡Œï¼Œç¬‘å®¹æ˜¯å¸¸æ€ï¼Œå¿ƒäº‹è¢«æ¸©æŸ”å®‰æ”¾ã€‚"
    ];

    const windowColors = [
      "#fff7d6", "#ffe8e8", "#e4f5ff", "#e3ffe4",
      "#ffe5fb", "#e7fff8", "#fdf1ff", "#f9ffe3"
    ];

    let blessingCreateTimer = null;

    function cleanupBlessingWindows() {
      if (blessingCreateTimer) {
        clearInterval(blessingCreateTimer);
        blessingCreateTimer = null;
      }
      blessingOverlay.querySelectorAll(".blessing-window").forEach(el => el.remove());
    }

    function createBlessingWindows() {
      // æ¸…ç†æ—§çš„å°çª—å’Œè®¡æ—¶å™¨
      cleanupBlessingWindows();

      const count = 30; // ä¸€å…±å¼¹å¤šå°‘ä¸ªå°çª—
      const vw = window.innerWidth;
      const vh = window.innerHeight;
      let created = 0;

      blessingCreateTimer = setInterval(() => {
        if (created >= count) {
          clearInterval(blessingCreateTimer);
          blessingCreateTimer = null;
          return;
        }

        const win = document.createElement("div");
        win.className = "blessing-window";

        const title = document.createElement("div");
        title.className = "blessing-window-header";

        const titleLeft = document.createElement("div");
        titleLeft.className = "blessing-window-header-title";

        const dot = document.createElement("div");
        dot.className = "blessing-window-header-dot";

        const titleText = document.createElement("span");
        titleText.textContent = "æ¸©é¦¨æç¤º";

        titleLeft.appendChild(dot);
        titleLeft.appendChild(titleText);
        title.appendChild(titleLeft);

        const body = document.createElement("div");
        body.className = "blessing-window-body";
        const textIndex = Math.floor(Math.random() * blessingsArr.length);
        body.textContent = blessingsArr[textIndex];

        const colorIndex = Math.floor(Math.random() * windowColors.length);
        body.style.setProperty("--window-bg", windowColors[colorIndex]);

        win.appendChild(title);
        win.appendChild(body);

        // éšæœºä½ç½®ï¼ˆé¢„ç•™ä¸€ç‚¹è¾¹è·ï¼Œé¿å…å®Œå…¨è´´è¾¹ï¼‰
        const w = 260;
        const h = 110;
        const maxLeft = Math.max(0, vw - w - 20);
        const maxTop = Math.max(0, vh - h - 40);
        const left = 10 + Math.random() * maxLeft;
        const top = 20 + Math.random() * maxTop;

        win.style.left = left + "px";
        win.style.top = top + "px";

        blessingOverlay.appendChild(win);

        // ä¸‹ä¸€å¸§å†åŠ  .showï¼Œè§¦å‘ CSS åŠ¨ç”»
        requestAnimationFrame(() => {
          win.classList.add("show");
        });

        created++;
      }, 170); // æ¯ 180ms å‡ºç°ä¸€ä¸ªå°çª—ï¼Œå¯ä»¥æ ¹æ®æ„Ÿè§‰è°ƒå¿«/è°ƒæ…¢
    }

    navBlessingsLink?.addEventListener("click", (e) => {
      e.preventDefault();
      createBlessingWindows();
      blessingOverlay.classList.add("active");
    });

    blessingCloseBtn?.addEventListener("click", () => {
      blessingOverlay.classList.remove("active");
      cleanupBlessingWindows();
    });

    // ç‚¹å‡»é®ç½©ç©ºç™½å¤„å…³é—­
    blessingOverlay?.addEventListener("click", (e) => {
      if (e.target === blessingOverlay) {
        blessingOverlay.classList.remove("active");
        cleanupBlessingWindows();
      }
    });


    // ================== æ„¿æœ›æœ¬åœ°ä¿å­˜ï¼ˆlocalStorageï¼‰ ==================
    const wishInput = document.getElementById("wishInput");
    const saveWishBtn = document.getElementById("saveWish");
    const clearWishBtn = document.getElementById("clearWish");
    const wishHint = document.getElementById("wishSavedHint");
    const WISH_KEY = "my_new_year_wish";

    let storageEnabled = true;
    try {
      const testKey = "__test_wish_key__";
      localStorage.setItem(testKey, "1");
      localStorage.removeItem(testKey);
    } catch (e) {
      storageEnabled = false;
    }

    (function initWish() {
      if (!storageEnabled) {
        wishHint.textContent = "å½“å‰æµè§ˆå™¨ä¸æ”¯æŒæœ¬åœ°å­˜å‚¨ï¼Œä½†ä½ ä»ç„¶å¯ä»¥åœ¨è¿™é‡Œå†™ä¸‹æ„¿æœ›ï½";
        return;
      }
      const saved = localStorage.getItem(WISH_KEY);
      if (saved) {
        wishInput.value = saved;
        wishHint.textContent = "å·²ä»æœ¬åœ°è¯»å–ä½ ä¹‹å‰ä¿å­˜çš„æ„¿æœ› âœ¨";
      }
    })();

    saveWishBtn.addEventListener("click", () => {
      const text = wishInput.value.trim();
      if (!text) {
        wishHint.textContent = "æ„¿æœ›å†…å®¹ä¸ºç©ºå“¦ï¼Œå¯ä»¥å†™ç‚¹ä»€ä¹ˆå†ä¿å­˜ï½";
        return;
      }
      if (!storageEnabled) {
        wishHint.textContent = "å½“å‰ç¯å¢ƒä¸æ”¯æŒæœ¬åœ°ä¿å­˜ï¼Œä½†æ„¿æœ›å·²ç»å†™åœ¨è¿™é‡Œå•¦ï½";
        return;
      }
      localStorage.setItem(WISH_KEY, text);
      wishHint.textContent = "å·²ä¿å­˜åˆ°æœ¬åœ°æµè§ˆå™¨ï¼Œä¸‹æ¬¡æ‰“å¼€é¡µé¢ä»ç„¶å¯ä»¥çœ‹åˆ° âœ…";
    });

    clearWishBtn.addEventListener("click", () => {
      wishInput.value = "";
      if (storageEnabled) {
        localStorage.removeItem(WISH_KEY);
      }
      wishHint.textContent = "å·²æ¸…ç©ºæ„¿æœ›å†…å®¹ï¼Œå¯ä»¥é‡æ–°å¼€å§‹ä¹¦å†™æ–°æ„¿æœ›ï½";
    });

    // ================== éŸ³ä¹æ§åˆ¶ ==================
    const bgm = document.getElementById("bgm");
    const musicToggle = document.getElementById("musicToggle");
    const musicIcon = document.getElementById("musicIcon");
    const musicText = document.getElementById("musicText");

    let isPlaying = false;

    musicToggle.addEventListener("click", async () => {
      if (!bgm) return;
      try {
        if (!isPlaying) {
          await bgm.play();
          isPlaying = true;
          musicIcon.textContent = "ğŸµ";
          musicText.textContent = "ç‚¹å‡»æš‚åœéŸ³ä¹";
        } else {
          bgm.pause();
          isPlaying = false;
          musicIcon.textContent = "ğŸ”‡";
          musicText.textContent = "ç‚¹å‡»æ’­æ”¾éŸ³ä¹";
        }
      } catch (e) {
        console.warn("æ’­æ”¾éŸ³ä¹å¤±è´¥ï¼š", e);
        musicText.textContent = "æµè§ˆå™¨é˜»æ­¢è‡ªåŠ¨æ’­æ”¾ï¼Œè¯·å†ç‚¹å‡»ä¸€æ¬¡å°è¯•ï½";
      }
    });

    // èƒŒæ™¯çƒŸèŠ±ç‰¹æ•ˆ
    // ================== ğŸ† é¡¶çº§è±ªåçƒŸèŠ±ç³»ç»Ÿï¼ˆå¿ƒå½¢ + é»„é‡‘æ‹–å°¾ + çˆ†é—ª + éœ‡åŠ¨ï¼‰ ==================
    const canvas = document.getElementById("fireworksCanvas");
    const ctx = canvas.getContext("2d");

    function resizeCanvas() {
      canvas.width = window.innerWidth;
      canvas.height = window.innerHeight;
    }
    resizeCanvas();
    window.addEventListener("resize", resizeCanvas);

    let fireworks = [];
    let particles = [];

    const settings = {
      gravity: 0.14,
      friction: 0.93,
      launchChance: 0.05,
      heartChance: 0.2,     // 20% ç”Ÿæˆå¿ƒå½¢çƒŸèŠ±
      megaChance: 0.2,      // 20% ç”Ÿæˆâ€œå·¨å‹ç¤¼èŠ±é˜µâ€
      shockwave: true,
      flash: true,
    };

    // éšæœºå‡½æ•°
    function random(min, max) { return Math.random() * (max - min) + min; }

    // å¹³é¢å¿ƒå½¢å‡½æ•°ï¼ˆæ ¸å¿ƒï¼‰
    function heartShape(t) {
      return {
        x: 16 * Math.pow(Math.sin(t), 3),
        y:
          13 * Math.cos(t) -
          5 * Math.cos(2 * t) -
          2 * Math.cos(3 * t) -
          Math.cos(4 * t),
      };
    }

    class Firework {
      constructor(startX, startY, targetX, targetY, useHeart = false, mega = false) {
        this.x = startX;
        this.y = startY;
        this.targetX = targetX;
        this.targetY = targetY;
        this.useHeart = useHeart;
        this.mega = mega;

        this.distanceToTarget = 0;

        this.angle = Math.atan2(targetY - startY, targetX - startX);
        this.speed = random(3, 5);
        this.brightness = random(70, 100);

        this.coordinates = [];
        for (let i = 0; i < 8; i++) this.coordinates.push([this.x, this.y]);
      }

      update(index) {
        this.coordinates.pop();
        this.coordinates.unshift([this.x, this.y]);

        const vx = Math.cos(this.angle) * this.speed;
        const vy = Math.sin(this.angle) * this.speed;

        this.x += vx;
        this.y += vy;

        const dx = this.x - this.targetX;
        const dy = this.y - this.targetY;
        this.distanceToTarget = Math.sqrt(dx * dx + dy * dy);

        if (this.distanceToTarget <= 10) {
          // çˆ†ç‚¸
          this.explode();
          fireworks.splice(index, 1);
        }
      }

      explode() {
    const count = this.mega ? 200 : 80;

    // åˆ é™¤é—ªå…‰å’Œéœ‡åŠ¨

    for (let i = 0; i < count; i++) {
        const p = new Particle(
            this.x,
            this.y,
            this.useHeart ? heartShape(i / 30) : null
        );
        particles.push(p);
    }
}

      draw() {
        ctx.beginPath();
        const [lastX, lastY] = this.coordinates[this.coordinates.length - 1];
        ctx.moveTo(lastX, lastY);
        ctx.lineTo(this.x, this.y);
        ctx.strokeStyle = `hsl(${random(0, 360)}, 100%, ${this.brightness}%)`;
        ctx.stroke();
      }
    }

    class Particle {
      constructor(x, y, heartPoint = null) {
        this.x = x;
        this.y = y;

        this.coordinates = [];
        for (let i = 0; i < 10; i++) this.coordinates.push([this.x, this.y]);

        if (heartPoint) {
          this.angle = Math.atan2(heartPoint.y, heartPoint.x);
          this.speed = random(2, 8);
        } else {
          this.angle = random(0, Math.PI * 2);
          this.speed = random(2, 11);
        }

        this.friction = settings.friction;
        this.gravity = settings.gravity;
        this.alpha = 1;
        this.decay = random(0.008, 0.018);
        this.hue = random(0, 360);

        this.twinkle = Math.random() > 0.8;
      }

      update(index) {
        this.coordinates.pop();
        this.coordinates.unshift([this.x, this.y]);

        this.speed *= this.friction;

        this.x += Math.cos(this.angle) * this.speed;
        this.y += Math.sin(this.angle) * this.speed + this.gravity;

        this.alpha -= this.decay;

        if (this.alpha <= 0) particles.splice(index, 1);
      }

      draw() {
        ctx.beginPath();
        const [lx, ly] = this.coordinates[this.coordinates.length - 1];
        ctx.moveTo(lx, ly);
        ctx.lineTo(this.x, this.y);

        ctx.strokeStyle = this.twinkle
          ? `rgba(255,255,255,${this.alpha})`
          : `hsla(${this.hue},100%,60%,${this.alpha})`;

        ctx.lineWidth = 2;
        ctx.stroke();
      }
    }

    // ä¸»å¾ªç¯
    function animate() {
      requestAnimationFrame(animate);

      ctx.globalCompositeOperation = "destination-out";
      ctx.fillStyle = "rgba(0, 0, 0, 0.15)";
      ctx.fillRect(0, 0, canvas.width, canvas.height);

      ctx.globalCompositeOperation = "lighter";

      if (Math.random() < settings.launchChance) {
        const startX = canvas.width / 2;
        const startY = canvas.height;

        const targetX = random(0, canvas.width);
        const targetY = random(canvas.height * 0.1, canvas.height * 0.5);

        const isHeart = Math.random() < settings.heartChance;
        const isMega = Math.random() < settings.megaChance;

        fireworks.push(new Firework(startX, startY, targetX, targetY, isHeart, isMega));
      }

      fireworks.forEach((fw, i) => {
        fw.update(i);
        fw.draw();
      });

      particles.forEach((p, i) => {
        p.update(i);
        p.draw();
      });
    }
    animate();


    // ç‚¹å‡»ä»»æ„ä½ç½®ç”ŸæˆçƒŸèŠ±
    canvas.addEventListener("click", (e) => {
      fireworks.push(
        new Firework(
          canvas.width / 2,
          canvas.height,
          e.clientX,
          e.clientY,
          Math.random() < 0.5,
          Math.random() < 0.3
        )
      );
    });

  </script>
</body>

</html>